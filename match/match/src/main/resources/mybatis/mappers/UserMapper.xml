<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.club.match.Mapper.UserMapper">

    <insert id="insertUser">
        INSERT INTO user_tbl (
            userId,
            password,
            name,
            nickName,
            gender,
            birthday,
            phone,
            address,
            profile,
            manner,
            introduction,
            points,
            isPrivate
        ) VALUES (
                     #{userId},
                     #{password},
                     #{name},
                     #{nickName},
                     #{gender},
                     #{birthday},
                     #{phone},
                     #{address},
                     #{profile},
                     #{manner},
                     #{introduction},
                     #{points},
                     #{isPrivate}
                 )
    </insert>

    <select id="selectUserPhone" resultType="int">
        SELECT COUNT(*) FROM user_tbl WHERE phone=#{phone};
    </select>

    <delete id="deleteUser">
        DELETE FROM user_tbl WHERE userId = #{userId};
    </delete>


    <select id="selectAt" resultType="UserDTO">
        SELECT * FROM user_tbl WHERE userId=#{userId};
    </select>

    <select id="selectUserTag" resultType="String">
        SELECT tag FROM preferencetag_tbl WHERE userId = #{userId};
    </select>

    <insert id="insertUserTag">
        INSERT INTO preferencetag_tbl VALUES(#{userId},#{tag});
    </insert>

    <delete id="deleteUserTag">
        DELETE FROM preferencetag_tbl where userId = #{userId} and tag = #{tag};
    </delete>

    <update id="updateUserInfo">
        UPDATE user_tbl SET ${type} = #{value} where userId = #{userId};
    </update>

    <update id="updateUserPassword">
        UPDATE user_tbl SET password = #{password} where userId = #{userId};
    </update>


    <insert id="insertSocialLink">
        INSERT INTO sociallink_tbl VALUES(#{userId},#{platformType},#{linkedId},#{email});
    </insert>

    <delete id="deleteSocialLink">
        DELETE FROM sociallink_tbl WHERE userId = #{userId} and platformType = #{platformType};
    </delete>

    <select id="userLinkAt" resultType="SocialLinkDTO">

        SELECT * FROM sociallink_tbl where
        <if test='!platformType.equals("0")'>
            platformType = #{platformType} and linkedId = #{linkedId};
        </if>
        <if test='platformType.equals("0")'>
            userId = #{userId};
        </if>

    </select>

</mapper>

