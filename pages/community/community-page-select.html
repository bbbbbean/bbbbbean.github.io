<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PlayMatch - 게시글 보기</title>
    <link
      rel="stylesheet"
      href="../../static/css/CSS_community-page/community-page-select.css"
    />
    <link
      rel="stylesheet"
      href="../../static/css/CSS_community-page/community-page-list.css"
    />
  </head>
  <body>
    <div class="forum-wrap">
      <div class="forum">
        <div class="forum-menu">
          <div class="forum-menu-el">
            <a href="javascript:void(0)">운동</a>
            <a href="javascript:void(0)" class="on">게임</a>
            <a href="javascript:void(0)">여행</a>
            <a href="javascript:void(0)">취미</a>
            <a href="javascript:void(0)">자유게시판</a>
          </div>
          <div class="forum-menu-serch">
            <input type="text" placeholder="검색어를 입력하세요" />
            <a href="javascript:void(0)">
              <img
                src="../../static/image/image_event/search_icon.svg"
                alt="검색"
              />
            </a>
          </div>
        </div>

        <div class="forum-view">
          <div class="view-header">
            <h2 class="view-title">게시판 테스트입니다</h2>
            <div class="view-info">
              <!-- 작성자 클릭하면 작성글 보기 등을 만들기 -->
              <span class="info-writer">작성자: a1234</span>
              <span class="info-date">작성일: 2025.05.05</span>
              <span class="info-hit">조회수: 100</span>
              <span class="info-like">추천: 25</span>
            </div>
          </div>
          <hr class="view-divider" />
          <div class="view-content">
            <p>테스트 내용</p>
            <img src="../../static/image/로고.png" alt="" />
            <p>테스트 내용 2</p>
          </div>
          <hr class="view-divider" />
          <div class="view-buttons">
            <!-- 권한 등에 따라 표시하기 -->
            <a href="javascript:void(0)" class="button">목록</a>
            <a href="javascript:void(0)" class="button">수정</a>
            <a href="javascript:void(0)" class="button">삭제</a>
          </div>
          <!-- 댓글 개수 한 30개 정도 나오면 페이지 스위칭으로 이동 -->
          <div class="view-comment">
            <h3 style="margin: 0; padding-left: 30px">댓글</h3>
            <ul class="comment-list">
              <li class="comment-item">
                <p>테스트 댓글 1</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user1</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 2</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 3</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 4</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 5</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 6</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 7</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 8</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 9</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 10</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 11</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 12</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 13</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 14</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 15</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 16</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 17</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 18</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 19</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 20</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user2</span>
                  <span class="comment-date">작성일: 2025.05.05</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 21</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user20</span>
                  <span class="comment-date">작성일: 2025.05.06</span>
                </div>
              </li>
              <li class="comment-item">
                <p>테스트 댓글 22</p>
                <div class="comment-info">
                  <span class="comment-writer">작성자: user21</span>
                  <span class="comment-date">작성일: 2025.05.06</span>
                  <!-- 내가 쓴 글만 삭제할 수 있도록 나중에 수정 -->
                  <a
                    href="javascript:void(0)"
                    class="button"
                    id="comment-delete"
                    >삭제</a
                  >
                </div>
              </li>
            </ul>
            <!-- 댓글 페이지 번호 -->
            <div class="comment-pagination"></div>
            <div class="comment-input">
              <input
                type="text"
                placeholder="댓글을 입력하세요"
                id="commentInput"
              />
              <a href="javascript:void(0)" class="button" id="commentSubmit"
                >등록</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const commentList = document.querySelector(".comment-list");
      const commentPagination = document.querySelector(".comment-pagination");
      const commentsPerPage = 20; // 한 페이지에 보여줄 댓글 개수 설정
      const commentSubmitButton = document.getElementById("commentSubmit"); // 댓글 등록 버튼
      const commentInput = document.getElementById("commentInput");
      const commentDeleteButton = document.getElementById("comment-delete"); // 댓글 삭제 버튼

      let currentPage = 1; // 현재 페이지 번호를 저장하는 변수 추가
      let totalComments = 0; // 총 댓글 수
      let totalPages = 0; // 총 페이지 수

      function getCommentItems() {
        return commentList.querySelectorAll(".comment-item"); // 모든 댓글 요소 가져오기
      }

      function renderPagination(page) {
        commentPagination.innerHTML = ""; // 기존 버튼 초기화
        currentPage = page; // 현재 페이지 업데이트

        const currentCommentItems = getCommentItems(); // 현재 DOM의 댓글 목록을 가져옴
        totalComments = currentCommentItems.length; // 총 댓글 수 업데이트
        totalPages = Math.ceil(totalComments / commentsPerPage); // 총 페이지 수 업데이트

        if (totalPages > 1) {
          commentPagination.style.display = "flex"; // 댓글이 20개 초과 시 페이지네이션 표시, 스타일을 flex로 설정

          if (currentPage > 1) {
            const prevButton = document.createElement("a");
            prevButton.href = "javascript:void(0)";
            prevButton.textContent = "« 이전";
            prevButton.classList.add("prev");
            prevButton.addEventListener("click", () =>
              renderPagination(currentPage - 1)
            );
            commentPagination.appendChild(prevButton);
          } // 페이지 번호 버튼

          for (let i = 1; i <= totalPages; i++) {
            const pageButton = document.createElement("a");
            pageButton.href = "javascript:void(0)";
            pageButton.textContent = i;
            if (i === currentPage) {
              pageButton.classList.add("active");
            }
            pageButton.addEventListener("click", () => renderPagination(i));
            commentPagination.appendChild(pageButton);
          } // 다음 버튼

          if (currentPage < totalPages) {
            const nextButton = document.createElement("a");
            nextButton.href = "javascript:void(0)";
            nextButton.textContent = "다음 »";
            nextButton.classList.add("next");
            nextButton.addEventListener("click", () =>
              renderPagination(currentPage + 1)
            );
            commentPagination.appendChild(nextButton);
          }
        } else {
          commentPagination.style.display = "none"; // 댓글이 20개 이하면 숨김
        }
        const commentItems = getCommentItems(); // 댓글 요소 업데이트
        commentItems.forEach((comment, index) => {
          const startIndex = (currentPage - 1) * commentsPerPage; // 현재 페이지에 나타나야 할 댓글 인덱스
          const endIndex = startIndex + commentsPerPage; // 현재 페이지의 마지막 댓글 인덱스
          if (index >= startIndex && index < endIndex) {
            comment.style.display = "flex";
          } else {
            comment.style.display = "none";
          }
        });
      }

      // 댓글 등록 함수
      function addComment() {
        const commentText = commentInput.value.trim(); // 입력된 댓글 내용 가져오기
        if (commentText) {
          const newComment = document.createElement("li");
          newComment.classList.add("comment-item");
          newComment.innerHTML = `
            <p>${commentText}</p>
            <div class="comment-info">
              <span class="comment-writer">작성자: user</span>
              <span class="comment-date">작성일: ${new Date().toLocaleDateString()}</span>
            </div>`;

          commentList.appendChild(newComment);

          updateCommentInfoAndRender();

          commentInput.value = "";
        } else {
          alert("댓글 내용을 입력해주세요.");
        }
      }

      function deleteComment(event) {
        const commentItem = event.target.closest(".comment-item");
        if (commentItem) {
          commentList.removeChild(commentItem);
          updateCommentInfoAndRender();
        }
      }

      function initializeComments() {
        updateCommentInfoAndRender();
      }
      function updateCommentInfoAndRender() {
        commentItems = getCommentItems();
        totalComments = commentItems.length;
        totalPages = Math.ceil(totalComments / commentsPerPage);
        renderPagination(currentPage);
      }

      document.addEventListener("DOMContentLoaded", initializeComments);
      commentSubmitButton.addEventListener("click", addComment);
      commentInput.addEventListener("keypress", (event) => {
        if (event.key === "Enter") {
          addComment();
        }
      });

      commentDeleteButton.addEventListener("click", deleteComment);

      updateCommentInfoAndRender();
      renderPagination(totalPages); // 초기 페이지 렌더링
    </script>
  </body>
</html>
